"use strict";angular.module("shoutoutGetSubscriberAppInternal",["shoutoutGetSubscriberCommon"]),angular.module("shoutoutGetSubscriberApp",["shoutoutGetSubscriberAppInternal","shoutoutGetSubscriberTranslations","wixAngular","wix.common.bi","pascalprecht.translate","fedops"]).config(["fedopsLoggerProvider",function(a){a.setAppName("shoutout-get-subscriber"),a.setDisableAutoLoadFinish()}]).config(["wixAngularTopologyProvider","$translateProvider","GSBiProvider","$windowProvider","wixBiLoggerProvider",function(a,b,c,d,e){var f=d.$get(),g=f.metasiteId||"";c.setBiLogger(e),c.setMetasiteId(g),c.setConfig(c.MODULES.WIDGET),setTimeout(function(){var c=a.getStaticsUrl()+"scripts/locale/get-subscribers/messages_";b.useStaticFilesLoader({prefix:c,suffix:".json"})})}]),angular.module("so.gs.bi.internal",[]),angular.module("so.gs.bi",["so.gs.bi.internal","shoutoutGetSubscriberTranslations","wixAngular","wix.common.bi"]);var AppController=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=this;this.$scope=a,this.$window=b,this.$rootScope=c,this.$translate=d,this.$timeout=e,this.PhonePrefixes=f,this.Constants=g,this.gsLocalStorage=h,this.getSubscribersApi=i,this.settingsManager=j,this.wixBiLogger=k,this.fedopsLogger=l,this.FedopsInteractions=m,this.hideForm=!0,this.errorMessage="",this.isSubscribeSuccessful=!1,this.isExplicitConsentGiven=!1,this.language="En",this.$window.Wix.Performance.applicationLoaded(),this.fireAppLoadedBeat(2),this.fireAppLoadedBeat(4),this.fedopsLogger.appLoaded(),this.$window=b,this.phonePrefixes=f,this.language=b.defaultLocale,this.validatorPatterns={name:/(?!<[^>]+>).*/gi,email:/^\b[a-zA-Z0-9.!#$%&’*+\/=?^_`{|}~-]{1,50}@[a-zA-Z0-9-]{1,50}(?:\.[a-zA-Z0-9-]{2,20})+$/,phone:/^\d+$/},this.initializeSettings(j),this.subscribeToSettings(j),this.$window.Wix.addEventListener(this.$window.Wix.Events.EDIT_MODE_CHANGE,function(){return n.clearFields()})}return a.$inject=["$scope","$window","$rootScope","$translate","$timeout","PhonePrefixes","Constants","gsLocalStorage","getSubscribersApi","settingsManager","wixBiLogger","fedopsLogger","FedopsInteractions"],a.prototype.fireAppLoadedBeat=function(a){var b=this,c=this.$window.parsedQuery.vsi;this.$timeout(function(){b.wixBiLogger.log("APP_LOADED",{second_of_beat:a,vsi:c})},1e3*a)},a.prototype.subscribe=function(){if(this.ngForm.$setSubmitted(),this.wixBiLogger.log("SUBSCRIBE_CLICK"),this.ngForm.$valid){var a={name:this.getFormValue("subscriberName"),phone:this.getFormValue("subscriberPhone")?this.getFormValue("subscriberDialCode")+this.getFormValue("subscriberPhone"):null,email:this.getFormValue("subscriberEmail")};this.isInEditorOrPreviewMode()?this.setSuccessfullSubscribeSate():this.addSubscriber(a)}else this.errorMessage=this.getErrorMessage()},a.prototype.closePopup=function(){this.$window.Wix.closeWindow()},a.prototype.getSkin=function(){return this.getStyleClass("",this.settings.style.appStyle,this.Constants.APP_STYLE)||"strip"},a.prototype.getLayout=function(){return this.isInMobile()||this.isInPopup()?"layout-vertical":this.getStyleClass("layout-",this.settings.signupForm.layout,this.Constants.APP_LAYOUT)||"layout-vertical"},a.prototype.getHeaderAlignment=function(){return this.getStyleClass("align-header-",this.settings.style.headerAlignment,this.Constants.HEADER_ALIGNMENT)||"align-header-left"},a.prototype.getBodyAlignment=function(){return this.getStyleClass("align-body-",this.settings.style.bodyAlignment,this.Constants.BODY_ELEMENT_ALIGNMENT)||"align-body-left"},a.prototype.getInvalid=function(a){return this.ngForm.$submitted&&this.ngForm[a]?this.ngForm[a].$invalid?"invalid":"":!1},a.prototype.popupBackground=function(){return this.isInPopup()?"in-popup":""},a.prototype.isInEditorOrPreviewMode=function(){return this.isInEditor()||"preview"===this.$window.Wix.Utils.getViewMode()},a.prototype.isPreview=function(){return-1!==this.$window.location.search.indexOf("&preview=true")},a.prototype.hideFormIfPopupIsOpen=function(){return!this.isInPopup()&&this.hideForm},a.prototype.getErrorMessage=function(){var a=this,b=function(a){return Object.keys(a).reduce(function(b,c){return b+a[c].length},0)},c=function(b){return a.ngForm[b]&&a.ngForm[b].$invalid},d=[[this.ngForm.$error&&b(this.ngForm.$error)>1,"widget.error.required"],[c("subscriberName"),"widget.error.required"],[c("subscriberEmail"),"widget.error.email"],[c("subscriberPhone"),"widget.error.phone"]],e=d.filter(function(a){var b=a[0];return b})[0]||[],f=e[1],g=void 0===f?"":f;return this.$translate.instant(g)},a.prototype.setSuggestedPhonePrefix=function(){var a=this;this.settings.generalSettings.collectPhone&&this.getSubscribersApi.getUserLocationByIp().then(function(b){var c=a.PhonePrefixes.filter(function(a){return a.code===b.data.locationCode});a.setFormValue("subscriberDialCode",c[0].dialCode)})},a.prototype.setFormValue=function(a,b){this.ngForm&&this.ngForm[a]&&this.ngForm[a].$setViewValue(b)},a.prototype.getStyleClass=function(a,b,c){var d=(Object.keys(c).filter(function(a){return c[a]===b})||[""])[0].toString().toLowerCase().replace("_","-");return a+d},a.prototype.addSubscriber=function(a){var b=this;this.fedopsLogger.interactionStarted(this.FedopsInteractions.SUBSCRIBE),this.$window.Wix.Activities.getUserSessionToken(function(c){b.getSubscribersApi.subscribe(a,b.settings.generalSettings.subscriptionNotifications,c,b.isExplicitConsentGiven).then(function(a){b.fedopsLogger.interactionEnded(b.FedopsInteractions.SUBSCRIBE),b.setSuccessfullSubscribeSate(),b.wixBiLogger.log("SUBSCRIBE_SUCCESS"),b.$window.Wix.Analytics.trackEvent("Lead",{label:"New Subscriber"}),b.isInPopup()&&b.gsLocalStorage.markUserSubscribedThroughPopup()})["catch"](function(a){b.isSubscribeSuccessful=!1})})},a.prototype.initializeSettings=function(a){var b=this;a.getSettings().then(function(a){b.hideForm=!1,b.settings=a,b.style=a.style,b.generalSettings=a.generalSettings,b.signupForm=a.signupForm,b.popup=a.popup,b.gdpr=a.gdpr,b.setSuggestedPhonePrefix(),b.checkLanguage(a.language),b.checkPopup(),b.$rootScope.$emit("resizeApp")})},a.prototype.subscribeToSettings=function(a){var b=this;a.subscribeToSettingsUpdate(function(a){a&&(b.checkLanguage(a.language||b.language),a.style&&(b.settings.style=a.style),a.generalSettings&&(a.generalSettings.collectPhone&&b.setSuggestedPhonePrefix(),b.settings.generalSettings=a.generalSettings),a.signupForm&&(b.settings.signupForm=a.signupForm),a.popup&&(b.settings.popup=a.popup),a.openPopupPreview&&b.setWidgetParamsToStorage(),b.$rootScope.$emit("resizeApp"),b.$scope.$apply())})},a.prototype.setWidgetParamsToStorage=function(){this.gsLocalStorage.putWidgetUrlToStorage(),this.gsLocalStorage.putWidgetHeight(this.$window.innerHeight),this.gsLocalStorage.putWidgetWidth(this.$window.innerWidth)},a.prototype.getFormValue=function(a){return this.ngForm[a]&&this.ngForm[a].$modelValue||null},a.prototype.executePopupOptions=function(){this.hideForm=!0,this.gsLocalStorage.setPopupHasBeenShownFlag()},a.prototype.openPopup=function(a){var b=this,c=this.$window.location.href+"&inModal=true",d=this.$window.innerWidth+50,e=d>=400?d:400,f=800,g=this.$window.Wix.Theme.BARE;this.$timeout(function(){b.$window.Wix.openModal(c,e,f,function(){b.settings.popup.hideFormIfSubscribedViaPopup&&b.gsLocalStorage.userSubscribedThroughPopup()||(b.hideForm=!1,b.$scope.$digest())},g),b.executePopupOptions()},1e3*a)},a.prototype.needToOpenPopup=function(){return this.isInEditor()||!this.settings.popup.showPopup||this.isInPopup()||this.isInMobile()||this.gsLocalStorage.userSubscribedThroughPopup()||!this.settings.popup.showPopupOnEveryVisitForNonSubscriber&&this.gsLocalStorage.userSubscribedThroughPopup()||!this.settings.popup.showPopupOnEveryVisitForNonSubscriber&&this.gsLocalStorage.popupHasAlreadyBeenShown()?!1:!0},a.prototype.isInEditor=function(){return"editor"===this.$window.Wix.Utils.getViewMode()},a.prototype.isInPopup=function(){return-1!==this.$window.location.search.indexOf("&inModal=true")},a.prototype.isInMobile=function(){return"mobile"===this.$window.Wix.Utils.getDeviceType()},a.prototype.checkPopup=function(){this.needToOpenPopup()&&this.openPopup(this.popup.popupTimer)},a.prototype.checkLanguage=function(a){var b=this;this.language!==a&&this.$translate.use(a.toLowerCase()).then(function(){b.$translate.refresh(),b.language=a})},a.prototype.clearFields=function(){this.ngForm&&this.ngForm.$setPristine()},a.prototype.setSuccessfullSubscribeSate=function(){this.isSubscribeSuccessful=!0,this.clearFields(),this.$rootScope.$emit("resizeApp")},a}();angular.module("shoutoutGetSubscriberAppInternal").directive("getSubscribers",function(){return{restrict:"E",templateUrl:"modules/widget/main.html",controller:AppController,controllerAs:"main"}});var FedopsInteractions=function(){function a(){this.SUBSCRIBE="subscribe"}return a}();angular.module("shoutoutGetSubscriberAppInternal").constant("FedopsInteractions",new FedopsInteractions),angular.module("shoutoutGetSubscriberAppInternal").directive("focusFirstErroneousField",["$timeout",function(a){return{restrict:"A",scope:{focusFirstErroneousField:"="},link:function(b,c,d){b.$watch("focusFirstErroneousField",function(b){b&&a(function(){c.find(".invalid input").first().focus()})})}}}]),angular.module("shoutoutGetSubscriberAppInternal").directive("resize",["$window","$rootScope","Constants","settingsManager","lodash",function(a,b,c,d,e){return{restrict:"A",link:function(f,g){function h(){if(!j()){if(g.outerHeight()<10)return void m();if(d&&d.settings&&d.settings.style){var b=d.settings.style.appStyle;a.Wix.setHeight(g.outerHeight()+i(b))}}}function i(a){var b=(d={},d[c.APP_STYLE.POSTCARD]=23,d[c.APP_STYLE.ELEGANT]=20,d);return b[a]||0;var d}function j(){return-1!==a.location.search.indexOf("&inModal=true")}var k={textFont:{},numbers:{}},l=g.outerHeight(),m=e.debounce(h,300);f.$watch(h),b.$on("resizeApp",m),a.Wix.addEventListener(a.Wix.Events.STYLE_PARAMS_CHANGE,function(a){(e.isEqual(a.numbers,k.numbers)||e.isEqual(a.textFont,k.textFont))&&(h(),k=a)}),a.addEventListener("resize",function(){l!==a.innerHeight&&h(),l=a.innerHeight})}}}]);var PhonePrefixes=[{name:"Afghanistan",dialCode:"+93",code:"AF"},{name:"Albania",dialCode:"+355",code:"AL"},{name:"Algeria",dialCode:"+213",code:"DZ"},{name:"AmericanSamoa",dialCode:"+1 684",code:"AS"},{name:"Andorra",dialCode:"+376",code:"AD"},{name:"Angola",dialCode:"+244",code:"AO"},{name:"Anguilla",dialCode:"+1 264",code:"AI"},{name:"Antigua and Barbuda",dialCode:"+1268",code:"AG"},{name:"Argentina",dialCode:"+54",code:"AR"},{name:"Armenia",dialCode:"+374",code:"AM"},{name:"Aruba",dialCode:"+297",code:"AW"},{name:"Australia",dialCode:"+61",code:"AU"},{name:"Austria",dialCode:"+43",code:"AT"},{name:"Azerbaijan",dialCode:"+994",code:"AZ"},{name:"Bahamas",dialCode:"+1 242",code:"BS"},{name:"Bahrain",dialCode:"+973",code:"BH"},{name:"Bangladesh",dialCode:"+880",code:"BD"},{name:"Barbados",dialCode:"+1 246",code:"BB"},{name:"Belarus",dialCode:"+375",code:"BY"},{name:"Belgium",dialCode:"+32",code:"BE"},{name:"Belize",dialCode:"+501",code:"BZ"},{name:"Benin",dialCode:"+229",code:"BJ"},{name:"Bermuda",dialCode:"+1 441",code:"BM"},{name:"Bhutan",dialCode:"+975",code:"BT"},{name:"Bosnia and Herzegovina",dialCode:"+387",code:"BA"},{name:"Botswana",dialCode:"+267",code:"BW"},{name:"Brazil",dialCode:"+55",code:"BR"},{name:"British Indian Ocean Territory",dialCode:"+246",code:"IO"},{name:"Bulgaria",dialCode:"+359",code:"BG"},{name:"Burkina Faso",dialCode:"+226",code:"BF"},{name:"Burundi",dialCode:"+257",code:"BI"},{name:"Cambodia",dialCode:"+855",code:"KH"},{name:"Cameroon",dialCode:"+237",code:"CM"},{name:"Canada",dialCode:"+1",code:"CA"},{name:"Cape Verde",dialCode:"+238",code:"CV"},{name:"Cayman Islands",dialCode:"+ 345",code:"KY"},{name:"Central African Republic",dialCode:"+236",code:"CF"},{name:"Chad",dialCode:"+235",code:"TD"},{name:"Chile",dialCode:"+56",code:"CL"},{name:"China",dialCode:"+86",code:"CN"},{name:"Christmas Island",dialCode:"+61",code:"CX"},{name:"Colombia",dialCode:"+57",code:"CO"},{name:"Comoros",dialCode:"+269",code:"KM"},{name:"Congo",dialCode:"+242",code:"CG"},{name:"Cook Islands",dialCode:"+682",code:"CK"},{name:"Costa Rica",dialCode:"+506",code:"CR"},{name:"Croatia",dialCode:"+385",code:"HR"},{name:"Cuba",dialCode:"+53",code:"CU"},{name:"Cyprus",dialCode:"+357",code:"CY"},{name:"Czech Republic",dialCode:"+420",code:"CZ"},{name:"Denmark",dialCode:"+45",code:"DK"},{name:"Djibouti",dialCode:"+253",code:"DJ"},{name:"Dominica",dialCode:"+1 767",code:"DM"},{name:"Dominican Republic",dialCode:"+1 809",code:"DO"},{name:"Dominican Republic",dialCode:"+1 829",code:"DO"},{name:"Dominican Republic",dialCode:"+1 849",code:"DO"},{name:"Ecuador",dialCode:"+593",code:"EC"},{name:"Egypt",dialCode:"+20",code:"EG"},{name:"El Salvador",dialCode:"+503",code:"SV"},{name:"Equatorial Guinea",dialCode:"+240",code:"GQ"},{name:"Eritrea",dialCode:"+291",code:"ER"},{name:"Estonia",dialCode:"+372",code:"EE"},{name:"Ethiopia",dialCode:"+251",code:"ET"},{name:"Faroe Islands",dialCode:"+298",code:"FO"},{name:"Fiji",dialCode:"+679",code:"FJ"},{name:"Finland",dialCode:"+358",code:"FI"},{name:"France",dialCode:"+33",code:"FR"},{name:"French Guiana",dialCode:"+594",code:"GF"},{name:"French Polynesia",dialCode:"+689",code:"PF"},{name:"Gabon",dialCode:"+241",code:"GA"},{name:"Gambia",dialCode:"+220",code:"GM"},{name:"Georgia",dialCode:"+995",code:"GE"},{name:"Germany",dialCode:"+49",code:"DE"},{name:"Ghana",dialCode:"+233",code:"GH"},{name:"Gibraltar",dialCode:"+350",code:"GI"},{name:"Greece",dialCode:"+30",code:"GR"},{name:"Greenland",dialCode:"+299",code:"GL"},{name:"Grenada",dialCode:"+1 473",code:"GD"},{name:"Guadeloupe",dialCode:"+590",code:"GP"},{name:"Guam",dialCode:"+1 671",code:"GU"},{name:"Guatemala",dialCode:"+502",code:"GT"},{name:"Guinea",dialCode:"+224",code:"GN"},{name:"Guinea-Bissau",dialCode:"+245",code:"GW"},{name:"Guyana",dialCode:"+592",code:"GY"},{name:"Haiti",dialCode:"+509",code:"HT"},{name:"Honduras",dialCode:"+504",code:"HN"},{name:"Hungary",dialCode:"+36",code:"HU"},{name:"Iceland",dialCode:"+354",code:"IS"},{name:"India",dialCode:"+91",code:"IN"},{name:"Indonesia",dialCode:"+62",code:"ID"},{name:"Iraq",dialCode:"+964",code:"IQ"},{name:"Ireland",dialCode:"+353",code:"IE"},{name:"Israel",dialCode:"+972",code:"IL"},{name:"Italy",dialCode:"+39",code:"IT"},{name:"Jamaica",dialCode:"+1 876",code:"JM"},{name:"Japan",dialCode:"+81",code:"JP"},{name:"Jordan",dialCode:"+962",code:"JO"},{name:"Kazakhstan",dialCode:"+7 7",code:"KZ"},{name:"Kenya",dialCode:"+254",code:"KE"},{name:"Kiribati",dialCode:"+686",code:"KI"},{name:"Kuwait",dialCode:"+965",code:"KW"},{name:"Kyrgyzstan",dialCode:"+996",code:"KG"},{name:"Latvia",dialCode:"+371",code:"LV"},{name:"Lebanon",dialCode:"+961",code:"LB"},{name:"Lesotho",dialCode:"+266",code:"LS"},{name:"Liberia",dialCode:"+231",code:"LR"},{name:"Liechtenstein",dialCode:"+423",code:"LI"},{name:"Lithuania",dialCode:"+370",code:"LT"},{name:"Luxembourg",dialCode:"+352",code:"LU"},{name:"Madagascar",dialCode:"+261",code:"MG"},{name:"Malawi",dialCode:"+265",code:"MW"},{name:"Malaysia",dialCode:"+60",code:"MY"},{name:"Maldives",dialCode:"+960",code:"MV"},{name:"Mali",dialCode:"+223",code:"ML"},{name:"Malta",dialCode:"+356",code:"MT"},{name:"Marshall Islands",dialCode:"+692",code:"MH"},{name:"Martinique",dialCode:"+596",code:"MQ"},{name:"Mauritania",dialCode:"+222",code:"MR"},{name:"Mauritius",dialCode:"+230",code:"MU"},{name:"Mayotte",dialCode:"+262",code:"YT"},{name:"Mexico",dialCode:"+52",code:"MX"},{name:"Monaco",dialCode:"+377",code:"MC"},{name:"Mongolia",dialCode:"+976",code:"MN"},{name:"Montenegro",dialCode:"+382",code:"ME"},{name:"Montserrat",dialCode:"+1664",code:"MS"},{name:"Morocco",dialCode:"+212",code:"MA"},{name:"Myanmar",dialCode:"+95",code:"MM"},{name:"Namibia",dialCode:"+264",code:"NA"},{name:"Nauru",dialCode:"+674",code:"NR"},{name:"Nepal",dialCode:"+977",code:"NP"},{name:"Netherlands",dialCode:"+31",code:"NL"},{name:"Netherlands Antilles",dialCode:"+599",code:"AN"},{name:"New Caledonia",dialCode:"+687",code:"NC"},{name:"New Zealand",dialCode:"+64",code:"NZ"},{name:"Nicaragua",dialCode:"+505",code:"NI"},{name:"Niger",dialCode:"+227",code:"NE"},{name:"Nigeria",dialCode:"+234",code:"NG"},{name:"Niue",dialCode:"+683",code:"NU"},{name:"Norfolk Island",dialCode:"+672",code:"NF"},{name:"Northern Mariana Islands",dialCode:"+1 670",code:"MP"},{name:"Norway",dialCode:"+47",code:"NO"},{name:"Oman",dialCode:"+968",code:"OM"},{name:"Pakistan",dialCode:"+92",code:"PK"},{name:"Palau",dialCode:"+680",code:"PW"},{name:"Panama",dialCode:"+507",code:"PA"},{name:"Papua New Guinea",dialCode:"+675",code:"PG"},{name:"Paraguay",dialCode:"+595",code:"PY"},{name:"Peru",dialCode:"+51",code:"PE"},{name:"Philippines",dialCode:"+63",code:"PH"},{name:"Poland",dialCode:"+48",code:"PL"},{name:"Portugal",dialCode:"+351",code:"PT"},{name:"Puerto Rico",dialCode:"+1 787",code:"PR"},{name:"Puerto Rico",dialCode:"+1 939",code:"PR"},{name:"Qatar",dialCode:"+974",code:"QA"},{name:"Romania",dialCode:"+40",code:"RO"},{name:"Rwanda",dialCode:"+250",code:"RW"},{name:"Samoa",dialCode:"+685",code:"WS"},{name:"San Marino",dialCode:"+378",code:"SM"},{name:"Saudi Arabia",dialCode:"+966",code:"SA"},{name:"Senegal",dialCode:"+221",code:"SN"},{name:"Serbia",dialCode:"+381",code:"RS"},{name:"Seychelles",dialCode:"+248",code:"SC"},{name:"Sierra Leone",dialCode:"+232",code:"SL"},{name:"Singapore",dialCode:"+65",code:"SG"},{name:"Slovakia",dialCode:"+421",code:"SK"},{name:"Slovenia",dialCode:"+386",code:"SI"},{name:"Solomon Islands",dialCode:"+677",code:"SB"},{name:"South Africa",dialCode:"+27",code:"ZA"},{name:"South Georgia and the South Sandwich Islands",dialCode:"+500",code:"GS"},{name:"Spain",dialCode:"+34",code:"ES"},{name:"Sri Lanka",dialCode:"+94",code:"LK"},{name:"Sudan",dialCode:"+249",code:"SD"},{name:"Suriname",dialCode:"+597",code:"SR"},{name:"Swaziland",dialCode:"+268",code:"SZ"},{name:"Sweden",dialCode:"+46",code:"SE"},{name:"Switzerland",dialCode:"+41",code:"CH"},{name:"Tajikistan",dialCode:"+992",code:"TJ"},{name:"Thailand",dialCode:"+66",code:"TH"},{name:"Togo",dialCode:"+228",code:"TG"},{name:"Tokelau",dialCode:"+690",code:"TK"},{name:"Tonga",dialCode:"+676",code:"TO"},{name:"Trinidad and Tobago",dialCode:"+1 868",code:"TT"},{name:"Tunisia",dialCode:"+216",code:"TN"},{name:"Turkey",dialCode:"+90",code:"TR"},{name:"Turkmenistan",dialCode:"+993",code:"TM"},{name:"Turks and Caicos Islands",dialCode:"+1 649",code:"TC"},{name:"Tuvalu",dialCode:"+688",code:"TV"},{name:"Uganda",dialCode:"+256",code:"UG"},{name:"Ukraine",dialCode:"+380",code:"UA"},{name:"United Arab Emirates",dialCode:"+971",code:"AE"},{name:"UK",dialCode:"+44",code:"GB"},{name:"USA",dialCode:"+1",code:"US"},{name:"Uruguay",dialCode:"+598",code:"UY"},{name:"Uzbekistan",dialCode:"+998",code:"UZ"},{name:"Vanuatu",dialCode:"+678",code:"VU"},{name:"Wallis and Futuna",dialCode:"+681",code:"WF"},{name:"Yemen",dialCode:"+967",code:"YE"},{name:"Zambia",dialCode:"+260",code:"ZM"},{name:"Zimbabwe",dialCode:"+263",code:"ZW"},{name:"Bolivia, Plurinational State of",dialCode:"+591",code:"BO"},{name:"Brunei Darussalam",dialCode:"+673",code:"BN"},{name:"Cocos (Keeling) Islands",dialCode:"+61",code:"CC"},{name:"Congo, The Democratic Republic of the",dialCode:"+243",code:"CD"},{name:"Cote d'Ivoire",dialCode:"+225",code:"CI"},{name:"Falkland Islands (Malvinas)",dialCode:"+500",code:"FK"},{name:"Guernsey",dialCode:"+44",code:"GG"},{name:"Holy See (Vatican City State)",dialCode:"+379",code:"VA"},{name:"Hong Kong",dialCode:"+852",code:"HK"},{name:"Iran, Islamic Republic of",dialCode:"+98",code:"IR"},{name:"Isle of Man",dialCode:"+44",code:"IM"},{name:"Jersey",dialCode:"+44",code:"JE"},{name:"Korea, Democratic People's Republic of",dialCode:"+850",code:"KP"},{name:"Korea, Republic of",dialCode:"+82",code:"KR"},{name:"Lao People's Democratic Republic",dialCode:"+856",code:"LA"},{name:"Libyan Arab Jamahiriya",dialCode:"+218",code:"LY"},{name:"Macao",dialCode:"+853",code:"MO"},{name:"Macedonia, The Former Yugoslav Republic of",dialCode:"+389",code:"MK"},{name:"Micronesia, Federated States of",dialCode:"+691",code:"FM"},{name:"Moldova, Republic of",dialCode:"+373",code:"MD"},{name:"Mozambique",dialCode:"+258",code:"MZ"},{name:"Palestinian Territory, Occupied",dialCode:"+970",code:"PS"},{name:"Pitcairn",dialCode:"+872",code:"PN"},{name:"Réunion",dialCode:"+262",code:"RE"},{name:"Russia",dialCode:"+7",code:"RU"},{name:"Saint Barthélemy",dialCode:"+590",code:"BL"},{name:"Saint Helena, Ascension and Tristan Da Cunha",dialCode:"+290",code:"SH"},{name:"Saint Kitts and Nevis",dialCode:"+1 869",code:"KN"},{name:"Saint Lucia",dialCode:"+1 758",code:"LC"},{name:"Saint Martin",dialCode:"+590",code:"MF"},{name:"Saint Pierre and Miquelon",dialCode:"+508",code:"PM"},{name:"Saint Vincent and the Grenadines",dialCode:"+1 784",code:"VC"},{name:"Sao Tome and Principe",dialCode:"+239",code:"ST"},{name:"Somalia",dialCode:"+252",code:"SO"},{name:"Svalbard and Jan Mayen",dialCode:"+47",code:"SJ"},{name:"Syrian Arab Republic",dialCode:"+963",code:"SY"},{name:"Taiwan, Province of China",dialCode:"+886",code:"TW"},{name:"Tanzania, United Republic of",dialCode:"+255",code:"TZ"},{name:"Timor-Leste",dialCode:"+670",code:"TL"},{name:"Venezuela, Bolivarian Republic of",dialCode:"+58",code:"VE"},{name:"Viet Nam",dialCode:"+84",code:"VN"},{name:"Virgin Islands, British",dialCode:"+1 284",code:"VG"},{name:"Virgin Islands, U.S.",dialCode:"+1 340",code:"VI"}];angular.module("shoutoutGetSubscriberAppInternal").constant("PhonePrefixes",PhonePrefixes),angular.module("shoutoutGetSubscriberCommonInternal",["LocalStorageModule","ngLodash"]).config(["localStorageServiceProvider",function(a){a.setPrefix("ls").setStorageType("localStorage")}]).run(["settingsManager",function(a){}]),angular.module("shoutoutGetSubscriberCommon",["shoutoutGetSubscriberCommonInternal","shoutoutGetSubscriberTranslations","so.gs.bi","wixAngular","wix.common.bi"]).config(["$httpProvider","wixBiLoggerProvider","GSBiProvider","$windowProvider",function(a,b,c,d){a.interceptors.push("httpInterceptors")}]);var Constants=function(){function a(){this.APP_STYLE={CLASSIC:0,STRIP:1,POSTCARD:2,ELEGANT:3,HEADLINE:4},this.HEADER_ALIGNMENT={LEFT:0,CENTER:1,RIGHT:2},this.BODY_ELEMENT_ALIGNMENT={LEFT:0,RIGHT:1},this.APP_LAYOUT={HORIZONTAL:0,VERTICAL:1,OLD_HORIZONTAL:2}}return a}();angular.module("shoutoutGetSubscriberCommonInternal").value("Constants",new Constants);var DefaultSettings=function(){function a(){this.defaultSettings={version:10,language:window.defaultLocale||"En",generalSettings:{subscriptionNotifications:!0,collectName:!1,collectPhone:!1,nameRequired:!1,phoneRequired:!1,namePlaceholder:"",phonePlaceholder:"",emailPlaceholder:""},signupForm:{showTitle:!0,showSubtitle:!0,titleText:"",subtitleText:"",buttonText:"",thankYouTitleText:"",thankYouSubtitleText:"",layout:1},popup:{showPopup:!1,showPopupOnEveryVisitForNonSubscriber:!0,hideFormIfSubscribedViaPopup:!0,popupTimer:5,showSubtitle:!0,popupTitleText:"",popupSubtitleText:"",popupButtonText:"",popupThankYouTitle:"",popupThankYouSubtitle:""},style:{appStyle:1,headerAlignment:0,bodyAlignment:0,buttonAlignment:1},gdpr:{requireConsent:!1,consentMessage:"",isPrivacyPolicyLinkEnabled:!1,policyLinkText:"",policyLinkUrl:""}}}return a}();angular.module("shoutoutGetSubscriberCommonInternal").value("defaultSettings",new DefaultSettings);var SettingsManager=function(){function a(a,b,c,d,e,f){var g=this;this.$window=a,this.lodash=b,this.$timeout=c,this.$q=d,this.defaultSettings=e,this.getSubscribersApi=f,this.settingsExist=!1,this.settingsScope={scope:"COMPONENT"},this.currentVersion=10,this.subscribeToSettingsUpdate=function(a){g.$window.Wix.addEventListener(g.$window.Wix.Events.SETTINGS_UPDATED,function(b){g.callToOpenPopupPreview(b)?a(b):(g.settings=g.lodash.merge(g.settings,b),g.isOldApp=!1,g.cleanupIvalidGdprFields(g.settings),g.setPrivacyPolicyProtocol(g.settings),g.saveSettings(),a(g.settings))})},this.saveSettings=b.debounce(this.saveSettngs,500)}return a.$inject=["$window","lodash","$timeout","$q","defaultSettings","getSubscribersApi"],a.prototype.getSettings=function(){var a=this,b=this.$q.defer();return this.isAlreadyLoadedSettings(this.settings)?(b.resolve(this.settings),b.promise):this.$window.self===this.$window.top?(this.settings=this.defaultSettings.defaultSettings,b.resolve(this.settings),b.promise):(this.isInEditor()?this.checkEditorVersion().then(function(c){c?a.loadSettingsFromSite().then(function(c){a.isOldApp=!1,a.settingsExist=!0,c=a.lodash.merge(a.defaultSettings.defaultSettings,c),a.settings=c,b.resolve(c)})["catch"](function(c){a.loadSettingsFromServer().then(function(c){a.isOldApp=!0,a.settingsExist=!0,c=a.lodash.merge(a.defaultSettings.defaultSettings,c),a.settings=c,b.resolve(c)})["catch"](function(c){var d=c;d.instanceId=a.decodeInstance(a.getSubscribersApi.instance).instanceId,d.compId=a.getSubscribersApi.compId,a.isOldApp=!1,a.settingsExist=!1,a.settings=d,b.resolve(c)})}):a.loadSettingsFromServer().then(function(c){a.isOldApp=!0,a.settingsExist=!0,c=a.lodash.merge(a.defaultSettings.defaultSettings,c),a.settings=c,b.resolve(c)})["catch"](function(c){var d=c;d.instanceId=a.decodeInstance(a.getSubscribersApi.instance).instanceId,d.compId=a.getSubscribersApi.compId,a.isOldApp=!1,a.settingsExist=!1,a.settings=d,b.resolve(c)})}):this.loadSettingsFromSite().then(function(c){a.isOldApp=!1,a.settingsExist=!0,c=a.lodash.merge(a.defaultSettings.defaultSettings,c),a.settings=c,b.resolve(c)})["catch"](function(c){a.loadSettingsFromServer().then(function(c){a.isOldApp=!0,a.settingsExist=!0,c=a.lodash.merge(a.defaultSettings.defaultSettings,c),a.settings=c,b.resolve(c)})["catch"](function(c){var d=c;d.instanceId=a.decodeInstance(a.getSubscribersApi.instance).instanceId,d.compId=a.getSubscribersApi.compId,a.isOldApp=!1,a.settingsExist=!1,a.settings=d,b.resolve(c)})}),b.promise)},a.prototype.userHasOldPopupEnabled=function(){return this.settings?this.settings.popup.showPopup:!1},a.prototype.hasSingleField=function(){return!this.settings.generalSettings.collectName&&!this.settings.generalSettings.collectPhone},a.prototype.isHorizontalLayout=function(){return 0===this.settings.signupForm.layout},a.prototype.first=function(a){var b=!1;return this.$q(function(c){var d=function(a){b||(b=!0,c(a))};a.forEach(function(a){a.then(d)})})},a.prototype.isNewEditor=function(){var a=this;return this.$q(function(b){var c=a.$window.Wix.Features.Types.ADD_COMPONENT;a.$window.Wix.Features.isSupported(c,function(a){return b(a)})})},a.prototype.checkEditorVersion=function(){var a=this;return this.first([this.isNewEditor(),this.$timeout(function(){},2e3).then(function(){return a.isNewEditor()}),this.$timeout(function(){},6e3).then(function(){return a.isNewEditor()}),this.$timeout(function(){},12e3).then(function(){return a.isNewEditor()})]).then(function(a){return console.log("Get Subscribers, is feature supported:",a),a})},a.prototype.loadSettingsFromSite=function(){var a=this.$q.defer();return this.$window.Wix.Data.Public.get("settings",this.settingsScope,function(b){return a.resolve(b.settings)},function(b){return a.reject(null)}),a.promise},a.prototype.loadSettingsFromServer=function(){var a=this,b=this.$q.defer();return this.getSubscribersApi.loadSettings().then(function(c){var d=c.data;a.isSettingsEmpty(d)?b.reject(a.defaultSettings.defaultSettings):(d.style.appStyle>4&&(d.style.appStyle=a.determineStyle(d.style.appStyle)),d.signupForm.layout=a.determineLayout(d.signupForm.layout),b.resolve(d))})["catch"](function(c){b.reject(a.defaultSettings.defaultSettings)}),b.promise},a.prototype.isSettingsEmpty=function(a){return Object.keys(a.generalSettings).every(function(b){switch(a.generalSettings[b]){case null:return!0;default:return!1}})},a.prototype.isInEditor=function(){var a=this.$window.Wix.Utils.getViewMode();return"editor"===a||"preview"===a||null===a},a.prototype.transformStringVariables=function(a,b){for(var c=b.length,d=0;c>d;d++)"boolean"!=typeof a[b[d]]||a[b[d]]||(a[b[d]]="");return a},a.prototype.saveSettngs=function(){var a=this;this.checkEditorVersion().then(function(b){b?a.$window.Wix.Data.Public.set("settings",a.settings,a.settingsScope,function(b){a.isOldApp=!1},function(b){a.saveToDatabase()}):a.saveToDatabase()})},a.prototype.saveToDatabase=function(){var a=this.decodeInstance(this.getSubscribersApi.instance);this.settingsExist&&this.settings.instanceId===a.instanceId?(this.settings.signupForm.layout=this.mapToOldLayout(this.settings.signupForm.layout),this.getSubscribersApi.updateSettings(this.settings)):(this.settings.instanceId===a.originInstanceId&&(this.settings.instanceId=a.instanceId),this.settings.signupForm.layout=this.mapToOldLayout(this.settings.signupForm.layout),this.getSubscribersApi.saveSettings(this.settings),this.settingsExist=!0)},a.prototype.callToOpenPopupPreview=function(a){return this.lodash.has(a,"openPopupPreview")&&a.openPopupPreview},a.prototype.determineStyle=function(a){switch(a){case 10:return 0;case 16:return 1;case 12:return 2;case 13:return 3;case 14:return 4;default:return 1}},a.prototype.determineLayout=function(a){switch(a){case 1:return 1;case 4:return 2;case 0:return 0;default:return 1}},a.prototype.mapToOldLayout=function(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 4}},a.prototype.decodeInstance=function(a){var b=a.split(".")[1],c=this.$window.JSON.parse(this.$window.atob(b));return c},a.prototype.isAlreadyLoadedSettings=function(a){try{return!!(a&&a.generalSettings&&a.signupForm&&a.popup&&a.style)}catch(b){return!1}},a.prototype.cleanupIvalidGdprFields=function(a){a.gdpr.isPrivacyPolicyLinkEnabled&&0===a.gdpr.policyLinkUrl.length&&(a.gdpr.isPrivacyPolicyLinkEnabled=!1)},a.prototype.setPrivacyPolicyProtocol=function(a){var b=function(a){return/https?:\/\//.test(a)};if(!(a.gdpr.policyLinkUrl.length>0&&b(a.gdpr.policyLinkUrl))){var c=this.$window.location.protocol;a.gdpr.policyLinkUrl=c+"//"+a.gdpr.policyLinkUrl}},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("settingsManager",SettingsManager);var GSLocalStorageService=function(){function a(a,b){this.localStorageService=a,this.$window=b,this.USER_REGISTERED="user-registered",this.WIDGET_URL="widget-url",this.WIDGET_HEIGHT="widget-height",this.WIDGET_WIDTH="widget-width",this.DONT_SHOW_POPUP="snooze-dirty"}return a.$inject=["localStorageService","$window"],a.prototype.markUserSubscribedThroughPopup=function(){this.localStorageService.set(this.getUserRegisteredKey(),!0)},a.prototype.putWidgetUrlToStorage=function(){this.localStorageService.set(this.WIDGET_URL,this.$window.location.href+"&inModal=true&preview=true")},a.prototype.getWidgetUrl=function(){var a=this.localStorageService.get(this.WIDGET_URL);return this.localStorageService.remove(this.WIDGET_URL),a},a.prototype.getWidgetHeight=function(){return this.localStorageService.get(this.WIDGET_HEIGHT)},a.prototype.getWidgetWidth=function(){return this.localStorageService.get(this.WIDGET_WIDTH)},a.prototype.putWidgetHeight=function(a){this.localStorageService.set(this.WIDGET_HEIGHT,a)},a.prototype.putWidgetWidth=function(a){this.localStorageService.set(this.WIDGET_WIDTH,a)},a.prototype.userSubscribedThroughPopup=function(){return!!this.localStorageService.get(this.getUserRegisteredKey())},a.prototype.setPopupHasBeenShownFlag=function(){this.localStorageService.set(this.getDontShowPopupKey(),!0)},a.prototype.popupHasAlreadyBeenShown=function(){return!!this.localStorageService.get(this.getDontShowPopupKey())},a.prototype.getDontShowPopupKey=function(){return this.DONT_SHOW_POPUP+":"+this.$window.Wix.Utils.getInstanceId()},a.prototype.getUserRegisteredKey=function(){return this.USER_REGISTERED+":"+this.$window.Wix.Utils.getInstanceId()},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("gsLocalStorage",GSLocalStorageService);var GetSubscribersApi=function(){function a(a,b,c,d,e){var f=this;this.$http=a,this.$window=b,this.$location=c,this.lodash=d,this.$q=e,this.compId=null,this.instance=null,this.geoInfo=null,this.saveEmail=d.debounce(function(a){
f.sendEmailToServer(a)},500)}return a.$inject=["$http","$window","$location","lodash","$q"],a.prototype.subscribe=function(a,b,c,d){var e=this;return this.$q(function(a){e.$window.Wix.getSiteInfo(function(b){return a(b.url)})}).then(function(f){return e.$http({method:"POST",url:"api/contacts",headers:{"X-Wix-comp-Id":e.getCompId(),"X-Wix-Instance":e.getInstance()},data:e.lodash.merge(a,{consent:d,formUrl:f}),params:{sendNotification:b,svSession:c}})})},a.prototype.loadSettings=function(){return this.$http({method:"GET",url:"api/settings",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()}})},a.prototype.saveSettings=function(a){return this.$http({method:"POST",url:"api/settings",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()},data:a})},a.prototype.updateSettings=function(a){return this.$http({method:"PUT",url:"api/settings",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()},data:a})},a.prototype.sendEmailToOwner=function(){return this.$http({method:"POST",url:"api/sendEmailToOwner",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()}})},a.prototype.getUserLocationByIp=function(){var a=this;return this.geoInfo?this.$q.resolve(this.geoInfo):this.$http({method:"GET",url:"api/geoinfo",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()}}).then(function(b){return a.geoInfo=b,b})},a.prototype.getEmail=function(){return this.$http({method:"GET",url:"api/useremail",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()}}).then(function(a){return a.data.email})},a.prototype.sendEmailToServer=function(a){return this.$http({method:"POST",url:"api/useremail",headers:{"X-Wix-comp-Id":this.getCompId(),"X-Wix-Instance":this.getInstance()},data:{email:a}})},a.prototype.getInstance=function(){return this.instance||(this.instance=this.$location.absUrl().split("instance=")[1].split("&")[0]),this.instance},a.prototype.getCompId=function(){return this.compId||(this.compId=this.$window.Wix.Utils.getOrigCompId()||this.$window.Wix.Utils.getCompId()),this.compId},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("getSubscribersApi",GetSubscribersApi);var WixService=function(){function a(a){this.$window=a,this.wix=this.$window.Wix}return a.$inject=["$window"],a.prototype.getInstance=function(){return this.instance?this.instance:(this.instance=this.$window.location.search.split("instance=")[1].split("&")[0],this.instance)},a.prototype.isInMobile=function(){return"mobile"===this.wix.Utils.getDeviceType()},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("wix",WixService);var Interceptors=function(){function a(){}return a.prototype.request=function(a){if(-1!==a.url.indexOf("api/")){var b=window.location.host+window.location.pathname.split("/static")[0];a.url=window.location.protocol+"//"+b+"/"+a.url}return a},a}();angular.module("shoutoutGetSubscriberCommonInternal").service("httpInterceptors",Interceptors),function(){var a=function(){function a(){this.MODULES={WIDGET:"WIDGET",SETTINGS:"SETTINGS"},this.EVENTS_MAP={WIDGET:{SUBSCRIBE_CLICK:{evid:300},SUBSCRIBE_SUCCESS:{evid:301},APP_LOADED:{evid:303}},SETTINGS:{FORM_NOTIFICATION_SWITCH:{evid:210},FORM_FIELD_MOBILE_MANDATORY:{evid:211},FORM_FIELD_MOBILE_SWITCH:{evid:212},FORM_FIELD_NAME_MANDATORY:{evid:213},FORM_FIELD_NAME_SWITCH:{evid:214},SIGNUP_FORM_TITLE_CHECKBOX_CLICK:{evid:215},TAB_CLICK:{evid:216},CHANGE_LAYOUT:{evid:217},CHANGE_TEMPLATE:{evid:219},REMOVE_OLD_POPUP:{evid:221},SEND_BEAUTIFUL_NEWSLETTER:{evid:223}}},this.hostname="frog.wix.com"}return a.prototype.setBiLogger=function(a){this.biLogger=a},a.prototype.setMetasiteId=function(a){this.metasiteId=a||"00000000-0000-0000-0000-000000000000"},a.prototype.setConfig=function(a){this.biLogger.setConfig({hostName:this.hostname,eventMap:this.EVENTS_MAP[a],defaultEventArgs:{src:36,msid:this.metasiteId},adapter:"shout"})},a.prototype.$get=function(){return this},a}();angular.module("so.gs.bi.internal").provider("GSBi",a)}();